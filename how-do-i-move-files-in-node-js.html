<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>How do I move files in node.js? -</title><meta name=robots content="index,follow,noarchive"><meta name=description content="How can I move files (like mv command shell) on node.js? Is there any method for that or should I read a file, write to a new file and remove older file?
0 17 Answers  According to seppo0010 comment, I used the rename function to do that.
http://nodejs.org/docs/latest/api/fs.html#fs_fs_rename_oldpath_newpath_callback
fs.rename(oldPath, newPath, callback)
Added in: v0.0.2 oldPath <String> | <Buffer> newPath <String> | <Buffer> callback <Function>  Asynchronous rename(2). No arguments other than a possible exception are given to the completion callback."><meta name=author content="Jenniffer Sheldon"><link rel="preload stylesheet" as=style href=https://assets.cdnweb.info/hugo/paper/css/app.css><link rel="preload stylesheet" as=style href=https://assets.cdnweb.info/hugo/paper/css/an-old-hope.min.css><script defer src=https://assets.cdnweb.info/hugo/paper/js/highlight.min.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=preload as=image href=./theme.png><link rel=icon href=./favicon.ico><link rel=apple-touch-icon href=./apple-touch-icon.png><meta name=generator content="Hugo 0.98.0"><meta property="og:title" content="How do I move files in node.js?"><meta property="og:description" content="How can I move files (like mv command shell) on node.js? Is there any method for that or should I read a file, write to a new file and remove older file? According to seppo0010 comment, I used the rename function to do that."><meta property="og:type" content="article"><meta property="og:url" content="/how-do-i-move-files-in-node-js.html"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-07-27T00:00:00+00:00"><meta property="article:modified_time" content="2024-07-27T00:00:00+00:00"><meta itemprop=name content="How do I move files in node.js?"><meta itemprop=description content="How can I move files (like mv command shell) on node.js? Is there any method for that or should I read a file, write to a new file and remove older file? According to seppo0010 comment, I used the rename function to do that."><meta itemprop=datePublished content="2024-07-27T00:00:00+00:00"><meta itemprop=dateModified content="2024-07-27T00:00:00+00:00"><meta itemprop=wordCount content="1120"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="How do I move files in node.js?"><meta name=twitter:description content="How can I move files (like mv command shell) on node.js? Is there any method for that or should I read a file, write to a new file and remove older file? According to seppo0010 comment, I used the rename function to do that."></head><body class=not-ready data-menu=true><header class=header><p class=logo><a class=site-name href=./index.html>PicoD</a><a class=btn-dark></a></p><script>let bodyClx=document.body.classList,btnDark=document.querySelector(".btn-dark"),sysDark=window.matchMedia("(prefers-color-scheme: dark)"),darkVal=localStorage.getItem("dark"),setDark=e=>{bodyClx[e?"add":"remove"]("dark"),localStorage.setItem("dark",e?"yes":"no")};setDark(darkVal?darkVal==="yes":sysDark.matches),requestAnimationFrame(()=>bodyClx.remove("not-ready")),btnDark.addEventListener("click",()=>setDark(!bodyClx.contains("dark"))),sysDark.addEventListener("change",e=>setDark(e.matches))</script><nav class=menu><a href=./sitemap.xml>Sitemap</a></nav></header><main class=main><article class=post-single><header class=post-title><p><time>Jul 27, 2024</time>
<span>Jenniffer Sheldon</span></p><h1>How do I move files in node.js?</h1></header><section class=post-content><img src=https://cdn.statically.io/img/cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png style=margin:auto;display:block;text-align:center;max-width:100%;height:auto><p>How can I move files (like mv command shell) on node.js? Is there any method for that or should I read a file, write to a new file and remove older file?</p><span class=d-none itemprop=commentCount>0</span><h2 class=mb0 data-answercount=17>17 Answers</h2><p>According to seppo0010 comment, I used the rename function to do that.</p><p><a href=# rel=noreferrer>http://nodejs.org/docs/latest/api/fs.html#fs_fs_rename_oldpath_newpath_callback</a></p><p>fs.rename(oldPath, newPath, callback)</p><h1>Added in: v0.0.2</h1><pre><code>oldPath &lt;String&gt; | &lt;Buffer&gt; newPath &lt;String&gt; | &lt;Buffer&gt; callback &lt;Function&gt; </code></pre><p>Asynchronous rename(2). No arguments other than a possible exception are given to the completion callback.</p><span class=d-none itemprop=commentCount>2</span><p>Using nodejs natively</p><pre><code>var fs = require('fs') var oldPath = 'old/path/file.txt' var newPath = 'new/path/file.txt' fs.rename(oldPath, newPath, function (err) { if (err) throw err console.log('Successfully renamed - AKA moved!') }) </code></pre><p>(NOTE: "This will not work if you are crossing partitions or using a virtual filesystem not supporting moving files. [...]" – Flavien Volken Sep 2 '15 at 12:50")</p><span class=d-none itemprop=commentCount></span><p>This example taken from: <a href=# rel=noreferrer>Node.js in Action</a></p><p>A move() function that renames, if possible, or falls back to copying</p><pre><code>var fs = require('fs'); module.exports = function move(oldPath, newPath, callback) { fs.rename(oldPath, newPath, function (err) { if (err) { if (err.code === 'EXDEV') { copy(); } else { callback(err); } return; } callback(); }); function copy() { var readStream = fs.createReadStream(oldPath); var writeStream = fs.createWriteStream(newPath); readStream.on('error', callback); writeStream.on('error', callback); readStream.on('close', function () { fs.unlink(oldPath, callback); }); readStream.pipe(writeStream); } } </code></pre><span class=d-none itemprop=commentCount>6</span><p>Use the <a href=# rel=noreferrer>mv</a> node module which will first try to do an <code>fs.rename</code> and then fallback to copying and then unlinking.</p><span class=d-none itemprop=commentCount>3</span><p><code>util.pump</code> is deprecated in node 0.10 and generates warning message</p><pre><code> util.pump() is deprecated. Use readableStream.pipe() instead </code></pre><p>So the solution for copying files using streams is:</p><pre><code>var source = fs.createReadStream('/path/to/source'); var dest = fs.createWriteStream('/path/to/dest'); source.pipe(dest); source.on('end', function() { /* copied */ }); source.on('error', function(err) { /* error */ }); </code></pre><span class=d-none itemprop=commentCount>1</span><p>The <code>fs-extra</code> module allows you to do this with it's <code>move()</code> method. I already implemented it and it works well if you want to completely move a file from one directory to another - ie. removing the file from the source directory. Should work for most basic cases.</p><pre><code>var fs = require('fs-extra') fs.move('/tmp/somefile', '/tmp/does/not/exist/yet/somefile', function (err) { if (err) return console.error(err) console.log("success!") }) </code></pre><span class=d-none itemprop=commentCount>2</span><p>Using promises for Node versions greater than 8.0.0:</p><pre><code>const {promisify} = require('util'); const fs = require('fs'); const {join} = require('path'); const mv = promisify(fs.rename); const moveThem = async () =&gt; { // Move file ./bar/foo.js to ./baz/qux.js const original = join(__dirname, 'bar/foo.js'); const target = join(__dirname, 'baz/qux.js'); await mv(original, target); } moveThem(); </code></pre><span class=d-none itemprop=commentCount>4</span><p>Using the rename function:</p><pre><code>fs.rename(getFileName, __dirname + '/new_folder/' + getFileName); </code></pre><p>where</p><pre><code>getFilename = file.extension (old path) __dirname + '/new_folder/' + getFileName </code></pre><p>assumming that you want to keep the file name unchanged.</p><span class=d-none itemprop=commentCount>1</span><p>Here's an example using util.pump, from >> <a href=#>How do I move file a to a different partition or device in Node.js?</a></p><pre><code>var fs = require('fs'), util = require('util'); var is = fs.createReadStream('source_file') var os = fs.createWriteStream('destination_file'); util.pump(is, os, function() { fs.unlinkSync('source_file'); }); </code></pre><span class=d-none itemprop=commentCount>4</span><p>Just my 2 cents as stated in the <a href=#>answer above</a> : The copy() method shouldn't be used as-is for copying files without a slight adjustment:</p><pre><code>function copy(callback) { var readStream = fs.createReadStream(oldPath); var writeStream = fs.createWriteStream(newPath); readStream.on('error', callback); writeStream.on('error', callback); // Do not callback() upon "close" event on the readStream // readStream.on('close', function () { // Do instead upon "close" on the writeStream writeStream.on('close', function () { callback(); }); readStream.pipe(writeStream); } </code></pre><p>The copy function wrapped in a Promise:</p><pre><code>function copy(oldPath, newPath) { return new Promise((resolve, reject) =&gt; { const readStream = fs.createReadStream(oldPath); const writeStream = fs.createWriteStream(newPath); readStream.on('error', err =&gt; reject(err)); writeStream.on('error', err =&gt; reject(err)); writeStream.on('close', function() { resolve(); }); readStream.pipe(writeStream); }) </code></pre><p>However, keep in mind that the filesystem might crash if the target folder doesn't exist.</p><span class=d-none itemprop=commentCount></span><p>I would separate all involved functions (i.e. <code>rename</code>, <code>copy</code>, <code>unlink</code>) from each other to gain flexibility and promisify everything, of course:</p><pre><code>const renameFile = (path, newPath) =&gt; new Promise((res, rej) =&gt; { fs.rename(path, newPath, (err, data) =&gt; err ? rej(err) : res(data)); }); const copyFile = (path, newPath, flags) =&gt; new Promise((res, rej) =&gt; { const readStream = fs.createReadStream(path), writeStream = fs.createWriteStream(newPath, {flags}); readStream.on("error", rej); writeStream.on("error", rej); writeStream.on("finish", res); readStream.pipe(writeStream); }); const unlinkFile = path =&gt; new Promise((res, rej) =&gt; { fs.unlink(path, (err, data) =&gt; err ? rej(err) : res(data)); }); const moveFile = (path, newPath, flags) =&gt; renameFile(path, newPath) .catch(e =&gt; { if (e.code !== "EXDEV") throw new e; else return copyFile(path, newPath, flags) .then(() =&gt; unlinkFile(path)); }); </code></pre><p><code>moveFile</code> is just a convenience function and we can apply the functions separately, when, for example, we need finer grained exception handling.</p><span class=d-none itemprop=commentCount></span><p><a href=# rel="nofollow noreferrer">Shelljs</a> is a very handy solution.</p><p>command: mv([options ,] source, destination)</p><p>Available options:</p><p>-f: force (default behaviour)</p><p>-n: to prevent overwriting</p><pre><code>const shell = require('shelljs'); const status = shell.mv('README.md', '/home/my-dir'); if(status.stderr) console.log(status.stderr); else console.log('File moved!'); </code></pre><span class=d-none itemprop=commentCount>1</span><p>this is a rehash of <a href=#>teoman shipahi's answer</a> with a slightly less ambiguous name, and following the design priciple of defining code before you attempt to call it. (Whilst node allows you to do otherwise, it's not good a practice to put the cart before the horse.)</p><pre><code>function rename_or_copy_and_delete (oldPath, newPath, callback) { function copy_and_delete () { var readStream = fs.createReadStream(oldPath); var writeStream = fs.createWriteStream(newPath); readStream.on('error', callback); writeStream.on('error', callback); readStream.on('close', function () { fs.unlink(oldPath, callback); } ); readStream.pipe(writeStream); } fs.rename(oldPath, newPath, function (err) { if (err) { if (err.code === 'EXDEV') { copy_and_delete(); } else { callback(err); } return;// &lt;&lt; both cases (err/copy_and_delete) } callback(); } ); } </code></pre><span class=d-none itemprop=commentCount></span><p>If you are trying to move or rename a node.js source file, try this <a href=# rel=nofollow>https://github.com/viruschidai/node-mv</a>. It will update the references to that file in all other files.</p><span class=d-none itemprop=commentCount></span><p>With the help of below URL, you can either copy or move your file CURRENT Source to Destination Source</p><p><a href=# rel="nofollow noreferrer">https://coursesweb.net/nodejs/move-copy-file</a></p><pre class="snippet-code-js lang-js prettyprint-override"><code>/*********Moves the $file to $dir2 Start *********/ var moveFile = (file, dir2)=&gt;{ //include the fs, path modules var fs = require('fs'); var path = require('path'); //gets file name and adds it to dir2 var f = path.basename(file); var dest = path.resolve(dir2, f); fs.rename(file, dest, (err)=&gt;{ if(err) throw err; else console.log('Successfully moved'); }); }; //move file1.htm from 'test/' to 'test/dir_1/' moveFile('./test/file1.htm', './test/dir_1/'); /*********Moves the $file to $dir2 END *********/ /*********copy the $file to $dir2 Start *********/ var copyFile = (file, dir2)=&gt;{ //include the fs, path modules var fs = require('fs'); var path = require('path'); //gets file name and adds it to dir2 var f = path.basename(file); var source = fs.createReadStream(file); var dest = fs.createWriteStream(path.resolve(dir2, f)); source.pipe(dest); source.on('end', function() { console.log('Succesfully copied'); }); source.on('error', function(err) { console.log(err); }); }; //example, copy file1.htm from 'test/dir_1/' to 'test/' copyFile('./test/dir_1/file1.htm', './test/'); /*********copy the $file to $dir2 END *********/</code></pre><span class=d-none itemprop=commentCount></span><p><code>fs.rename</code> is also available in the sync version:</p><pre class="lang-js prettyprint-override"><code>fs.renameSync(oldPath, newPath) </code></pre><span class=d-none itemprop=commentCount></span><p>Node.js v10.0.0+</p><pre><code>const fs = require('fs') const { promisify } = require('util') const pipeline = promisify(require('stream').pipeline) await pipeline( fs.createReadStream('source/file/path'), fs.createWriteStream('destination/file/path') ).catch(err =&gt; { // error handling }) fs.unlink('source/file/path') </code></pre><span class=d-none itemprop=commentCount></span><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmirpJawrLvVnqmfpJ%2Bse6S7zGiorp2jqbawutJob25vaWWCdnvHqK5mnJ9itm65zq%2BcZp6ZobK0ecinZKenlJp6q78%3D</p></section><nav class=post-nav><a class=prev href=./what-is-wrong-with-brandy-norwood.html><span>←</span><span>Fans Are Worried About R&amp;amp;B Singer Brandy Norwood After Numerous Health Scares</span></a>
<a class=next href=./how-old-do-you-have-to-be-to-work-at-finish-line.html><span>How old do you have to be to work at Finish Line?</span><span>→</span></a></nav></article></main><footer class=footer><p>&copy; 2024 <a href=./></a></p><p>Powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>️</p></footer><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>